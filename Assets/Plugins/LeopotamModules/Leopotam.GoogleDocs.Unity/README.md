<p align="center">
    <img src="./logo.png" alt="Logo">
</p>

# Загрузка с GoogleDocs
Поддержка загрузки GoogleDocs-документов по прямым ссылкам.

> **ВАЖНО!** Требует C#9 (или Unity >=2021.2).

> **ВАЖНО!** Проверено на Unity 2021.3 (зависит от нее) и содержит asmdef-описания для компиляции в виде отдельных сборок и уменьшения времени рекомпиляции основного проекта.


# Социальные ресурсы
[Официальный блог](https://leopotam.com)


# Установка


## В виде исходников
Поддерживается установка в виде исходников из архива, который надо распаковать в проект.


## Прочие источники
Официальные версии выпускаются для активных подписчиков в виде ссылок на актуальные версии.


# Подготовка данных
> **ВАЖНО!** Рекомендуется явно ограничить количество столбцов в табличном документе, иначе возможен экспорт лишних пустых ячеек, занимающих место.

> **ВАЖНО!** Рекомендуется явно переключить у всех ячеек формат чисел с "Автоматический формат" на "Простой текст", иначе сервис экспорта может решить, что весь столбец должен содержать числа, если в нем будет цифр больше, чем строк (строковые ячейки будут иметь пустые значения).

> **ВАЖНО!** Скачивание возможно только если документ доступен по публичной ссылке (на чтение или запись).

> **ВАЖНО!** Не рекомендуется давать доступ на запись по публичной ссылке.

> **ВАЖНО!** Не рекомендуется использовать скачивание данных с GoogleDocs в релизных билдах:
> * Время отклика не гарантировано, может достигать десятка секунд.
> * Лимит по обращению к документу может быстро переполниться на сотнях одновременных обращениях и документ будет заблокирован на какое-то время.

# Чтение таблиц
Поддерживается чтение данных из `GoogleSheets` через указание ссылки и имени страницы. Ссылку можно скопировать прямо из адресной
строки браузера или через `Sharing`-диалог.

```c#
// Прямая ссылка на документ.
string url = "https://docs.google.com/spreadsheets/d/1_xxxxxxx-yyyy/edit#gid=0";
// Имя страницы.
string page = "Common";
(string csv, string err) = await GoogleDocsLoader.LoadCsvPage (url, page);
if (err != null) {
    // Что-то пошло не так, в err текст ошибки.
}
// Можно работать со строкой csv-данных.
```


# Лицензия
Расширение выпускается под коммерческой лицензией, [подробности тут](./LICENSE.md).
